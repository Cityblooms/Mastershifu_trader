<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gold RSI Trading Signals - Real-Time</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 1000px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            color: #ffd700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .header p {
            color: #b8b8b8;
            font-size: 1em;
        }

        .status-bar {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .status-item {
            display: flex;
            flex-direction: column;
        }

        .status-label {
            color: #b8b8b8;
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .status-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #ffd700;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: rgba(0, 184, 148, 0.2);
            border-radius: 20px;
        }

        .live-dot {
            width: 10px;
            height: 10px;
            background: #00b894;
            border-radius: 50%;
            animation: blink 2s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .signal-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 35px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 25px;
        }

        .signal-display {
            text-align: center;
            margin-bottom: 30px;
        }

        .signal-badge {
            display: inline-block;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 2em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: pulse 2s infinite;
        }

        .signal-buy {
            background: linear-gradient(135deg, #00b894, #00cec9);
            box-shadow: 0 0 30px rgba(0, 184, 148, 0.5);
        }

        .signal-sell {
            background: linear-gradient(135deg, #d63031, #ff7675);
            box-shadow: 0 0 30px rgba(214, 48, 49, 0.5);
        }

        .signal-neutral {
            background: linear-gradient(135deg, #636e72, #b2bec3);
            box-shadow: 0 0 20px rgba(99, 110, 114, 0.3);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .metric-box {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .metric-label {
            color: #b8b8b8;
            font-size: 0.9em;
            margin-bottom: 8px;
        }

        .metric-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd700;
        }

        .conditions-list {
            margin-top: 25px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
        }

        .conditions-list h3 {
            color: #ffd700;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .condition-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
        }

        .condition-icon {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            font-size: 1.2em;
        }

        .condition-met {
            color: #00b894;
        }

        .condition-not-met {
            color: #636e72;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #b8b8b8;
        }

        .error-message {
            background: rgba(214, 48, 49, 0.2);
            border: 1px solid rgba(214, 48, 49, 0.4);
            padding: 15px;
            border-radius: 10px;
            color: #ff7675;
            margin-bottom: 20px;
            text-align: center;
        }

        .disclaimer {
            text-align: center;
            color: #636e72;
            font-size: 0.85em;
            margin-top: 25px;
            padding: 15px;
            background: rgba(255, 0, 0, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(255, 0, 0, 0.2);
        }

        .refresh-btn {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border: none;
            padding: 10px 25px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Gold RSI Trading Signals</h1>
            <p>Real-time XAU/USD RSI analysis with live market data</p>
        </div>

        <div class="status-bar">
            <div class="status-item">
                <span class="status-label">Live Gold Price</span>
                <span class="status-value" id="goldPrice">Loading...</span>
            </div>
            <div class="status-item">
                <span class="status-label">Status</span>
                <div class="live-indicator">
                    <div class="live-dot"></div>
                    <span style="color: #00b894; font-weight: bold;">LIVE</span>
                </div>
            </div>
            <div class="status-item">
                <button class="refresh-btn" onclick="refreshData()">üîÑ Refresh</button>
            </div>
        </div>

        <div id="errorContainer"></div>

        <div class="signal-card">
            <div class="signal-display">
                <div class="signal-badge signal-neutral" id="signalBadge">ANALYZING...</div>
            </div>

            <div class="metrics-grid">
                <div class="metric-box">
                    <div class="metric-label">RSI (14)</div>
                    <div class="metric-value" id="rsiDisplay">--</div>
                </div>
                <div class="metric-box">
                    <div class="metric-label">Trend Status</div>
                    <div class="metric-value" id="trendDisplay" style="font-size: 1.3em;">--</div>
                </div>
                <div class="metric-box">
                    <div class="metric-label">Signal Strength</div>
                    <div class="metric-value" id="strengthDisplay">--</div>
                </div>
                <div class="metric-box">
                    <div class="metric-label">24h Change</div>
                    <div class="metric-value" id="changeDisplay">--</div>
                </div>
            </div>

            <div class="conditions-list" id="conditionsList">
                <h3>Signal Analysis</h3>
                <div class="loading">Fetching real-time market data...</div>
            </div>

            <div style="text-align: center; color: #b8b8b8; font-size: 0.9em; margin-top: 20px;" id="lastUpdate">
                Last updated: --
            </div>
        </div>

        <div class="disclaimer">
            ‚ö†Ô∏è <strong>Risk Disclaimer:</strong> This dashboard provides signals based on RSI analysis and real-time market data. Trading gold involves significant risk. Always use proper risk management, combine with multiple indicators, and never risk more than you can afford to lose. Past performance does not guarantee future results.
        </div>
    </div>

    <script>
        // Historical price data for RSI calculation (stored in memory)
        let priceHistory = [];
        const RSI_PERIOD = 14;
        let lastPrice = null;

        // Calculate RSI from price data
        function calculateRSI(prices) {
            if (prices.length < RSI_PERIOD + 1) {
                return null;
            }

            let gains = 0;
            let losses = 0;

            // Calculate initial average gain/loss
            for (let i = 1; i <= RSI_PERIOD; i++) {
                const change = prices[i] - prices[i - 1];
                if (change > 0) {
                    gains += change;
                } else {
                    losses += Math.abs(change);
                }
            }

            let avgGain = gains / RSI_PERIOD;
            let avgLoss = losses / RSI_PERIOD;

            // Calculate subsequent values
            for (let i = RSI_PERIOD + 1; i < prices.length; i++) {
                const change = prices[i] - prices[i - 1];
                const gain = change > 0 ? change : 0;
                const loss = change < 0 ? Math.abs(change) : 0;

                avgGain = (avgGain * (RSI_PERIOD - 1) + gain) / RSI_PERIOD;
                avgLoss = (avgLoss * (RSI_PERIOD - 1) + loss) / RSI_PERIOD;
            }

            if (avgLoss === 0) return 100;
            const rs = avgGain / avgLoss;
            return 100 - (100 / (1 + rs));
        }

        // Fetch real-time gold price
        async function fetchGoldPrice() {
            try {
                // Using a free gold price API
                const response = await fetch('https://data-asg.goldprice.org/dbXRates/USD');
                
                if (!response.ok) {
                    throw new Error('Failed to fetch gold price');
                }

                const data = await response.json();
                
                // Extract gold price (XAU)
                if (data && data.items && data.items[0]) {
                    const goldData = data.items[0];
                    return {
                        price: parseFloat(goldData.xauPrice),
                        change: parseFloat(goldData.chgXau),
                        timestamp: new Date()
                    };
                }
                
                throw new Error('Invalid data format');
            } catch (error) {
                console.error('Error fetching gold price:', error);
                throw error;
            }
        }

        // Analyze signal based on RSI
        function analyzeSignal(rsi, prevRsi, price) {
            const isOversold = rsi < 30;
            const isOverbought = rsi > 70;
            const isBullishDivergence = rsi > prevRsi && rsi < 40;
            const isBearishDivergence = rsi < prevRsi && rsi > 60;
            const rsiCrossingUp50 = prevRsi < 50 && rsi > 50;
            const rsiCrossingDown50 = prevRsi > 50 && rsi < 50;
            const rsiMomentumUp = rsi > prevRsi && (rsi - prevRsi) > 2;
            const rsiMomentumDown = rsi < prevRsi && (prevRsi - rsi) > 2;

            let signal = 'NO SIGNAL';
            let signalClass = 'signal-neutral';
            let strength = 'Neutral';
            let trend = 'Sideways';
            let conditions = [];

            // Buy Signal Logic
            if ((isOversold && rsiMomentumUp) || (isBullishDivergence) || (rsiCrossingUp50 && rsi < 60)) {
                signal = 'BUY';
                signalClass = 'signal-buy';
                trend = 'Bullish';
                
                let strengthScore = 0;
                if (isOversold) {
                    strengthScore += 3;
                    conditions.push({ met: true, text: `RSI deeply oversold (${rsi.toFixed(1)} < 30) - Strong buy zone` });
                }
                if (rsiMomentumUp) {
                    strengthScore += 2;
                    conditions.push({ met: true, text: `Strong upward RSI momentum (+${(rsi - prevRsi).toFixed(1)})` });
                }
                if (isBullishDivergence) {
                    strengthScore += 3;
                    conditions.push({ met: true, text: 'Bullish divergence detected - Potential reversal' });
                }
                if (rsiCrossingUp50) {
                    strengthScore += 2;
                    conditions.push({ met: true, text: 'RSI crossing above 50 (trend confirmation)' });
                }

                strength = strengthScore >= 5 ? 'Strong' : strengthScore >= 3 ? 'Moderate' : 'Weak';
            }
            // Sell Signal Logic
            else if ((isOverbought && rsiMomentumDown) || (isBearishDivergence) || (rsiCrossingDown50 && rsi > 40)) {
                signal = 'SELL';
                signalClass = 'signal-sell';
                trend = 'Bearish';
                
                let strengthScore = 0;
                if (isOverbought) {
                    strengthScore += 3;
                    conditions.push({ met: true, text: `RSI deeply overbought (${rsi.toFixed(1)} > 70) - Strong sell zone` });
                }
                if (rsiMomentumDown) {
                    strengthScore += 2;
                    conditions.push({ met: true, text: `Strong downward RSI momentum (-${(prevRsi - rsi).toFixed(1)})` });
                }
                if (isBearishDivergence) {
                    strengthScore += 3;
                    conditions.push({ met: true, text: 'Bearish divergence detected - Potential reversal' });
                }
                if (rsiCrossingDown50) {
                    strengthScore += 2;
                    conditions.push({ met: true, text: 'RSI crossing below 50 (trend reversal)' });
                }

                strength = strengthScore >= 5 ? 'Strong' : strengthScore >= 3 ? 'Moderate' : 'Weak';
            }
            // No Signal
            else {
                if (rsi >= 45 && rsi <= 55) {
                    conditions.push({ met: false, text: 'RSI in neutral zone (45-55) - No clear direction' });
                }
                if (rsi >= 30 && rsi <= 70) {
                    conditions.push({ met: false, text: 'RSI not in extreme territory - Wait for clearer setup' });
                }
                if (Math.abs(rsi - prevRsi) < 2) {
                    conditions.push({ met: false, text: 'Insufficient RSI momentum for signal generation' });
                }

                if (rsi > 50) {
                    trend = 'Mild Bullish';
                } else if (rsi < 50) {
                    trend = 'Mild Bearish';
                }
            }

            return { signal, signalClass, strength, trend, conditions };
        }

        // Update UI with signal data
        function updateUI(goldData, rsi, prevRsi) {
            // Update price display
            document.getElementById('goldPrice').textContent = `$${goldData.price.toFixed(2)}`;
            
            // Update change display
            const changeElement = document.getElementById('changeDisplay');
            const changePercent = ((goldData.change / goldData.price) * 100).toFixed(2);
            changeElement.textContent = `${goldData.change >= 0 ? '+' : ''}${changePercent}%`;
            changeElement.style.color = goldData.change >= 0 ? '#00b894' : '#d63031';

            // Analyze signal
            const analysis = analyzeSignal(rsi, prevRsi, goldData.price);

            // Update signal badge
            const badge = document.getElementById('signalBadge');
            badge.textContent = analysis.signal;
            badge.className = `signal-badge ${analysis.signalClass}`;

            // Update metrics
            document.getElementById('rsiDisplay').textContent = rsi.toFixed(1);
            document.getElementById('trendDisplay').textContent = analysis.trend;
            document.getElementById('strengthDisplay').textContent = analysis.strength;

            // Update conditions
            const conditionsList = document.getElementById('conditionsList');
            conditionsList.innerHTML = '<h3>Signal Analysis</h3>';
            
            analysis.conditions.forEach(condition => {
                const item = document.createElement('div');
                item.className = 'condition-item';
                item.innerHTML = `
                    <span class="condition-icon ${condition.met ? 'condition-met' : 'condition-not-met'}">
                        ${condition.met ? '‚úì' : '‚óã'}
                    </span>
                    <span>${condition.text}</span>
                `;
                conditionsList.appendChild(item);
            });

            // Update timestamp
            document.getElementById('lastUpdate').textContent = 
                `Last updated: ${goldData.timestamp.toLocaleString()}`;

            // Clear error
            document.getElementById('errorContainer').innerHTML = '';
        }

        // Main refresh function
        async function refreshData() {
            try {
                const goldData = await fetchGoldPrice();
                
                // Add to price history
                priceHistory.push(goldData.price);
                
                // Keep only last 50 prices for RSI calculation
                if (priceHistory.length > 50) {
                    priceHistory.shift();
                }

                // Calculate RSI if we have enough data
                if (priceHistory.length >= RSI_PERIOD + 1) {
                    const rsi = calculateRSI(priceHistory);
                    const prevRsi = priceHistory.length >= RSI_PERIOD + 2 ? 
                                    calculateRSI(priceHistory.slice(0, -1)) : rsi;
                    
                    updateUI(goldData, rsi, prevRsi);
                } else {
                    document.getElementById('conditionsList').innerHTML = `
                        <h3>Signal Analysis</h3>
                        <div class="loading">Collecting price data... (${priceHistory.length}/${RSI_PERIOD + 1} points needed)</div>
                    `;
                }

                lastPrice = goldData.price;
            } catch (error) {
                document.getElementById('errorContainer').innerHTML = `
                    <div class="error-message">
                        ‚ö†Ô∏è Unable to fetch real-time data. Please check your connection and try again.
                    </div>
                `;
                console.error('Error:', error);
            }
        }

        // Initialize on page load
        refreshData();

        // Auto-refresh every 60 seconds
        setInterval(refreshData, 60000);
    </script>
</body>
</html>
