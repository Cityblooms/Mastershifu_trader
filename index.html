<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>KILLER ZONE - Multi-Asset Visual Analysis Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<style>
    :root {
        --primary-bg: #0b102a;
        --secondary-bg: #121a3a;
        --accent-color: gold;
        --accent-dark: #b8860b;
        --positive: #00c853;
        --negative: #ff3d00;
        --neutral: #5d7bdb;
        --warning: #ff9800;
        --text-primary: #ffffff;
        --text-secondary: #cccccc;
        --border-radius: 8px;
        --shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        --london-session: #2196F3;
        --ny-session: #4CAF50;
        --gold: #FFD700;
        --btc: #F7931A;
        --forex: #00BFFF;
    }
    
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: var(--primary-bg);
        color: var(--text-primary);
        line-height: 1.6;
        overflow-x: hidden;
    }
    
    /* Header */
    .header {
        background: var(--secondary-bg);
        padding: 15px 20px;
        border-bottom: 2px solid var(--accent-color);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        box-shadow: var(--shadow);
    }
    
    .header-content {
        flex: 1;
        min-width: 300px;
    }
    
    h1 {
        color: var(--accent-color);
        margin-bottom: 5px;
        font-size: 1.8rem;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .tagline {
        color: var(--text-secondary);
        font-size: 0.9rem;
        margin-bottom: 5px;
    }
    
    .rules {
        font-size: 0.85rem;
        color: var(--neutral);
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 8px;
    }
    
    .rule {
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .rule i {
        color: var(--accent-color);
        font-size: 0.8rem;
    }
    
    /* Session Controls */
    .session-controls {
        background: rgba(0, 0, 0, 0.3);
        border-radius: var(--border-radius);
        padding: 15px;
        min-width: 250px;
        text-align: center;
    }
    
    .session-buttons {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
    
    .session-btn {
        flex: 1;
        padding: 8px 15px;
        border: none;
        border-radius: 6px;
        background: rgba(255, 255, 255, 0.1);
        color: white;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s;
    }
    
    .session-btn.active {
        background: var(--accent-color);
        color: var(--primary-bg);
    }
    
    .market-status {
        margin-top: 10px;
        padding: 8px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 4px;
        font-size: 0.9rem;
    }
    
    .status-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 5px;
    }
    
    .status-open {
        background: var(--positive);
        animation: pulse 2s infinite;
    }
    
    .status-closed {
        background: var(--negative);
    }
    
    @keyframes pulse {
        0% { opacity: 1; }
        50% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    /* Dashboard Layout */
    .dashboard-container {
        display: flex;
        height: calc(100vh - 150px);
        padding: 15px;
        gap: 15px;
    }
    
    /* Left Panel */
    .left-panel {
        width: 400px;
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    /* Asset Selection Panel */
    .asset-panel {
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        padding: 15px;
        box-shadow: var(--shadow);
    }
    
    .asset-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        color: var(--accent-color);
        font-weight: bold;
    }
    
    .asset-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
    }
    
    .asset-card {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 6px;
        padding: 12px;
        border: 2px solid transparent;
        transition: all 0.3s;
        cursor: pointer;
        position: relative;
    }
    
    .asset-card.active {
        border-color: var(--accent-color);
        background: rgba(255, 215, 0, 0.1);
    }
    
    .asset-card.gold {
        border-left: 4px solid var(--gold);
    }
    
    .asset-card.btc {
        border-left: 4px solid var(--btc);
    }
    
    .asset-card.forex {
        border-left: 4px solid var(--forex);
    }
    
    .asset-card.indices {
        border-left: 4px solid var(--neutral);
    }
    
    .asset-card.buy-signal {
        border-color: var(--positive);
        box-shadow: 0 0 10px rgba(0, 200, 83, 0.3);
    }
    
    .asset-card.sell-signal {
        border-color: var(--negative);
        box-shadow: 0 0 10px rgba(255, 61, 0, 0.3);
    }
    
    .signal-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        padding: 2px 6px;
        border-radius: 10px;
        font-size: 0.7rem;
        font-weight: bold;
    }
    
    .signal-buy {
        background: rgba(0, 200, 83, 0.2);
        color: var(--positive);
    }
    
    .signal-sell {
        background: rgba(255, 61, 0, 0.2);
        color: var(--negative);
    }
    
    .asset-name {
        font-size: 1rem;
        font-weight: bold;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .asset-price {
        font-size: 1.2rem;
        font-weight: bold;
        margin: 3px 0;
    }
    
    .asset-change {
        font-size: 0.85rem;
        padding: 2px 6px;
        border-radius: 10px;
        display: inline-block;
    }
    
    .change-up {
        background: rgba(0, 200, 83, 0.2);
        color: var(--positive);
    }
    
    .change-down {
        background: rgba(255, 61, 0, 0.2);
        color: var(--negative);
    }
    
    /* Visual Analysis Panel */
    .analysis-panel {
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        padding: 15px;
        box-shadow: var(--shadow);
        flex: 1;
        overflow-y: auto;
    }
    
    .analysis-header {
        color: var(--accent-color);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .analysis-section {
        margin-bottom: 20px;
    }
    
    .section-title {
        color: var(--accent-color);
        font-size: 1rem;
        margin-bottom: 10px;
        padding-bottom: 5px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .analysis-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-bottom: 15px;
    }
    
    .analysis-item {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 6px;
        padding: 10px;
        border-left: 4px solid var(--neutral);
    }
    
    .analysis-item.bullish {
        border-left-color: var(--positive);
        background: rgba(0, 200, 83, 0.1);
    }
    
    .analysis-item.bearish {
        border-left-color: var(--negative);
        background: rgba(255, 61, 0, 0.1);
    }
    
    .analysis-item.neutral {
        border-left-color: var(--warning);
        background: rgba(255, 152, 0, 0.1);
    }
    
    .item-title {
        font-weight: bold;
        font-size: 0.9rem;
        margin-bottom: 5px;
    }
    
    .item-value {
        font-size: 0.85rem;
        color: var(--text-secondary);
    }
    
    .confirmation-item {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 6px;
        padding: 10px;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .confirmation-item.confirmed {
        border-left: 4px solid var(--positive);
    }
    
    .confirmation-item.denied {
        border-left: 4px solid var(--negative);
    }
    
    .confirmation-check {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.7rem;
    }
    
    .check-confirmed {
        background: rgba(0, 200, 83, 0.2);
        color: var(--positive);
    }
    
    .check-denied {
        background: rgba(255, 61, 0, 0.2);
        color: var(--negative);
    }
    
    /* Signal Decision Panel */
    .signal-panel {
        background: var(--secondary-bg);
        border-radius: var(--border-radius);
        padding: 15px;
        box-shadow: var(--shadow);
    }
    
    .signal-header {
        color: var(--accent-color);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .signal-decision {
        text-align: center;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 15px;
        animation: fadeIn 0.5s;
    }
    
    .signal-buy-decision {
        background: rgba(0, 200, 83, 0.1);
        border: 2px solid var(--positive);
    }
    
    .signal-sell-decision {
        background: rgba(255, 61, 0, 0.1);
        border: 2px solid var(--negative);
    }
    
    .signal-no-trade {
        background: rgba(255, 152, 0, 0.1);
        border: 2px solid var(--warning);
    }
    
    .decision-text {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 10px;
    }
    
    .decision-buy {
        color: var(--positive);
    }
    
    .decision-sell {
        color: var(--negative);
    }
    
    .decision-no-trade {
        color: var(--warning);
    }
    
    .trend-bias {
        font-size: 1.1rem;
        margin-bottom: 10px;
        font-weight: bold;
    }
    
    .trend-bullish {
        color: var(--positive);
    }
    
    .trend-bearish {
        color: var(--negative);
    }
    
    .trend-ranging {
        color: var(--warning);
    }
    
    .analysis-summary {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 6px;
        padding: 12px;
        font-size: 0.9rem;
        line-height: 1.5;
    }
    
    /* Chart Container */
    .chart-container {
        flex: 1;
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: var(--shadow);
        display: flex;
        flex-direction: column;
    }
    
    .chart-header {
        background: var(--secondary-bg);
        padding: 12px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .chart-info {
        display: flex;
        flex-direction: column;
        gap: 5px;
    }
    
    .chart-symbol {
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--accent-color);
    }
    
    .chart-stats {
        display: flex;
        gap: 15px;
        font-size: 0.9rem;
        color: var(--text-secondary);
    }
    
    .timeframe-selector {
        display: flex;
        gap: 5px;
        background: rgba(0, 0, 0, 0.3);
        padding: 4px;
        border-radius: 6px;
    }
    
    .tf-btn {
        background: transparent;
        border: none;
        border-radius: 4px;
        padding: 6px 12px;
        color: var(--text-secondary);
        cursor: pointer;
        font-size: 0.85rem;
        transition: all 0.3s;
    }
    
    .tf-btn:hover {
        background: rgba(255, 255, 255, 0.1);
    }
    
    .tf-btn.active {
        background: var(--accent-color);
        color: var(--primary-bg);
        font-weight: bold;
    }
    
    /* Chart Tools */
    .chart-tools {
        display: flex;
        gap: 10px;
        margin-top: 10px;
    }
    
    .tool-btn {
        padding: 5px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 4px;
        color: var(--text-primary);
        cursor: pointer;
        font-size: 0.8rem;
        display: flex;
        align-items: center;
        gap: 5px;
    }
    
    .tool-btn.active {
        background: var(--neutral);
        color: white;
    }
    
    /* TradingView Chart */
    #tv_chart_container {
        flex: 1;
        position: relative;
    }
    
    /* Footer */
    .footer {
        background: var(--secondary-bg);
        padding: 10px 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        font-size: 0.8rem;
        color: var(--text-secondary);
        text-align: center;
    }
    
    .warning {
        color: #ff9800;
        margin: 5px 0;
        font-style: italic;
    }
    
    /* Responsive Design */
    @media (max-width: 1400px) {
        .dashboard-container {
            flex-direction: column;
            height: auto;
        }
        
        .left-panel {
            width: 100%;
            flex-direction: row;
            flex-wrap: wrap;
        }
        
        .asset-panel, .analysis-panel, .signal-panel {
            flex: 1;
            min-width: 300px;
        }
    }
    
    @media (max-width: 768px) {
        .header {
            flex-direction: column;
            text-align: center;
            gap: 15px;
        }
        
        .session-controls {
            width: 100%;
        }
        
        .left-panel {
            flex-direction: column;
        }
        
        .chart-header {
            flex-direction: column;
            gap: 10px;
            align-items: flex-start;
        }
        
        .timeframe-selector, .chart-tools {
            align-self: stretch;
            justify-content: center;
        }
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
</head>

<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <h1><i class="fas fa-binoculars"></i> KILLER ZONE - Visual Analysis Dashboard</h1>
            <p class="tagline">Multi-Asset Support • 3+ Visual Confirmations Required • No Conflicts Allowed</p>
            <div class="rules">
                <div class="rule"><i class="fas fa-eye"></i> Visual Analysis First</div>
                <div class="rule"><i class="fas fa-check-triple"></i> 3+ Confirmations Required</div>
                <div class="rule"><i class="fas fa-times"></i> No Conflicts Allowed</div>
                <div class="rule"><i class="fas fa-bullseye"></i> Accuracy Over Frequency</div>
            </div>
        </div>
        
        <div class="session-controls">
            <div>ANALYSIS MODE</div>
            <div class="session-buttons">
                <button class="session-btn active" data-mode="realtime">
                    <i class="fas fa-sync-alt"></i> Live Analysis
                </button>
                <button class="session-btn" data-mode="simulation">
                    <i class="fas fa-chart-bar"></i> Historical Test
                </button>
            </div>
            <div class="market-status">
                <span class="status-indicator status-open"></span>
                <span id="analysis-status">Live Analysis Active</span>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div class="dashboard-container">
        <!-- Left Panel -->
        <div class="left-panel">
            <!-- Asset Selection Panel -->
            <div class="asset-panel">
                <div class="asset-header">
                    <span><i class="fas fa-coins"></i> ASSET SELECTION</span>
                    <span id="asset-count">5 Assets</span>
                </div>
                <div class="asset-grid">
                    <div class="asset-card gold active" data-symbol="XAUUSD" data-name="Gold">
                        <div class="asset-name">
                            <i class="fas fa-gem" style="color:var(--gold)"></i>
                            <span>Gold (XAUUSD)</span>
                        </div>
                        <div class="asset-price" id="gold-price">2,180.45</div>
                        <div class="asset-change change-up" id="gold-change">+0.65%</div>
                    </div>
                    
                    <div class="asset-card btc" data-symbol="BTCUSD" data-name="Bitcoin">
                        <div class="asset-name">
                            <i class="fab fa-bitcoin" style="color:var(--btc)"></i>
                            <span>Bitcoin (BTCUSD)</span>
                        </div>
                        <div class="asset-price" id="btc-price">68,245.80</div>
                        <div class="asset-change change-up" id="btc-change">+2.35%</div>
                    </div>
                    
                    <div class="asset-card forex" data-symbol="EURUSD" data-name="EURUSD">
                        <div class="asset-name">
                            <i class="fas fa-euro-sign" style="color:var(--forex)"></i>
                            <span>EUR/USD</span>
                        </div>
                        <div class="asset-price" id="eurusd-price">1.0956</div>
                        <div class="asset-change change-down" id="eurusd-change">-0.15%</div>
                    </div>
                    
                    <div class="asset-card indices" data-symbol="NAS100" data-name="NAS100">
                        <div class="asset-name">
                            <i class="fas fa-chart-line" style="color:var(--neutral)"></i>
                            <span>NAS100</span>
                        </div>
                        <div class="asset-price" id="nas100-price">17,842.35</div>
                        <div class="asset-change change-up" id="nas100-change">+0.85%</div>
                    </div>
                    
                    <div class="asset-card indices" data-symbol="US30" data-name="US30">
                        <div class="asset-name">
                            <i class="fas fa-industry" style="color:var(--neutral)"></i>
                            <span>US30 (Dow)</span>
                        </div>
                        <div class="asset-price" id="us30-price">39,215.60</div>
                        <div class="asset-change change-down" id="us30-change">-0.32%</div>
                    </div>
                </div>
                <div style="margin-top: 15px; font-size: 0.85rem; color: var(--text-secondary);">
                    <i class="fas fa-mouse-pointer" style="color: var(--accent-color);"></i> 
                    Click any asset to analyze. Green/Red borders indicate signals.
                </div>
            </div>

            <!-- Visual Analysis Panel -->
            <div class="analysis-panel">
                <div class="analysis-header">
                    <span><i class="fas fa-chart-bar"></i> VISUAL ANALYSIS</span>
                    <span id="current-asset">Gold (XAUUSD)</span>
                </div>
                
                <!-- Market Structure -->
                <div class="analysis-section">
                    <div class="section-title">MARKET STRUCTURE</div>
                    <div class="analysis-grid">
                        <div class="analysis-item bullish" id="structure-hl">
                            <div class="item-title">Higher Lows</div>
                            <div class="item-value">Confirmed ✓</div>
                        </div>
                        <div class="analysis-item bullish" id="structure-hh">
                            <div class="item-title">Higher Highs</div>
                            <div class="item-value">Present ✓</div>
                        </div>
                        <div class="analysis-item" id="structure-lh">
                            <div class="item-title">Lower Highs</div>
                            <div class="item-value">Not Present</div>
                        </div>
                        <div class="analysis-item" id="structure-ll">
                            <div class="item-title">Lower Lows</div>
                            <div class="item-value">Not Present</div>
                        </div>
                    </div>
                </div>
                
                <!-- Trend & Indicators -->
                <div class="analysis-section">
                    <div class="section-title">TREND & MOMENTUM</div>
                    <div class="analysis-grid">
                        <div class="analysis-item bullish" id="trend-direction">
                            <div class="item-title">Trend Direction</div>
                            <div class="item-value">Bullish</div>
                        </div>
                        <div class="analysis-item neutral" id="rsi-status">
                            <div class="item-title">RSI Status</div>
                            <div class="item-value">62.5 (Neutral)</div>
                        </div>
                        <div class="analysis-item bullish" id="momentum">
                            <div class="item-title">Momentum</div>
                            <div class="item-value">Bullish Bars</div>
                        </div>
                        <div class="analysis-item" id="candle-pattern">
                            <div class="item-title">Candle Pattern</div>
                            <div class="item-value">Bullish Continuation</div>
                        </div>
                    </div>
                </div>
                
                <!-- Key Levels -->
                <div class="analysis-section">
                    <div class="section-title">KEY LEVELS</div>
                    <div class="analysis-grid">
                        <div class="analysis-item" id="support-level">
                            <div class="item-title">Support Zone</div>
                            <div class="item-value">2,165 - 2,170</div>
                        </div>
                        <div class="analysis-item" id="resistance-level">
                            <div class="item-title">Resistance Zone</div>
                            <div class="item-value">2,190 - 2,195</div>
                        </div>
                        <div class="analysis-item bullish" id="price-position">
                            <div class="item-title">Price Position</div>
                            <div class="item-value">Above Support ✓</div>
                        </div>
                        <div class="analysis-item" id="breakout-status">
                            <div class="item-title">Breakout Status</div>
                            <div class="item-value">Testing Resistance</div>
                        </div>
                    </div>
                </div>
                
                <!-- Visual Confirmations -->
                <div class="analysis-section">
                    <div class="section-title">VISUAL CONFIRMATIONS (3+ Required)</div>
                    <div id="confirmations-container">
                        <div class="confirmation-item confirmed">
                            <div class="confirmation-check check-confirmed">
                                <i class="fas fa-check"></i>
                            </div>
                            <div>
                                <div style="font-weight:bold;">Higher Lows Pattern</div>
                                <div style="font-size:0.8rem;color:var(--text-secondary)">Clear HH/HL structure confirms uptrend</div>
                            </div>
                        </div>
                        <div class="confirmation-item confirmed">
                            <div class="confirmation-check check-confirmed">
                                <i class="fas fa-check"></i>
                            </div>
                            <div>
                                <div style="font-weight:bold;">Trend Direction</div>
                                <div style="font-size:0.8rem;color:var(--text-secondary)">Clear bullish trend established</div>
                            </div>
                        </div>
                        <div class="confirmation-item confirmed">
                            <div class="confirmation-check check-confirmed">
                                <i class="fas fa-check"></i>
                            </div>
                            <div>
                                <div style="font-weight:bold;">Bullish Candlestick Pattern</div>
                                <div style="font-size:0.8rem;color:var(--text-secondary)">Series of bullish closes above key support</div>
                            </div>
                        </div>
                        <div class="confirmation-item">
                            <div class="confirmation-check">
                                <i class="fas fa-minus"></i>
                            </div>
                            <div>
                                <div style="font-weight:bold;">RSI Confirmation</div>
                                <div style="font-size:0.8rem;color:var(--text-secondary)">RSI neutral, not overbought/sold</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Signal Decision Panel -->
            <div class="signal-panel">
                <div class="signal-header">
                    <span><i class="fas fa-flag-checkered"></i> TRADE DECISION</span>
                    <span id="confirmation-count">3/4 Confirmations</span>
                </div>
                
                <div class="signal-decision signal-buy-decision">
                    <div class="trend-bias trend-bullish">
                        <i class="fas fa-arrow-up"></i> TREND BIAS: BULLISH
                    </div>
                    <div class="decision-text decision-buy">
                        <i class="fas fa-thumbs-up"></i> SIGNAL: BUY
                    </div>
                    <div style="font-size:0.9rem;margin-bottom:10px;color:var(--text-secondary)">
                        Confidence: High (3/4 visual confirmations)
                    </div>
                </div>
                
                <div class="analysis-summary">
                    <strong>ANALYSIS SUMMARY:</strong><br>
                    Gold shows a clear bullish structure with higher highs and higher lows. 
                    Price is trading in a confirmed uptrend with strong support at 2,165. 
                    Bullish candlestick patterns and momentum confirm the trend direction. 
                    RSI at 62.5 provides neutral confirmation without overbought concerns. 
                    No conflicting signals observed.
                </div>
                
                <div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.2); border-radius:6px; font-size:0.85rem;">
                    <div style="color:var(--accent-color);margin-bottom:5px;">
                        <i class="fas fa-exclamation-triangle"></i> KEY VISUAL CONFIRMATIONS:
                    </div>
                    <div>1. Higher Lows + Higher Highs pattern</div>
                    <div>2. Clear bullish trend direction</div>
                    <div>3. Bullish candlestick momentum above key support</div>
                </div>
            </div>
        </div>

        <!-- Chart Container -->
        <div class="chart-container">
            <div class="chart-header">
                <div class="chart-info">
                    <div class="chart-symbol" id="chart-symbol-name">Gold (XAUUSD) - 1H Chart</div>
                    <div class="chart-stats">
                        <span>Trend: <strong id="chart-trend" style="color:var(--positive)">Bullish</strong></span>
                        <span>RSI: <strong id="chart-rsi">62.5</strong></span>
                        <span>Structure: <strong id="chart-structure" style="color:var(--positive)">HH/HL</strong></span>
                        <span>Momentum: <strong id="chart-momentum" style="color:var(--positive)">Bullish</strong></span>
                    </div>
                    <div class="chart-tools">
                        <button class="tool-btn active" data-tool="trendlines">
                            <i class="fas fa-sliders-h"></i> Trendlines
                        </button>
                        <button class="tool-btn" data-tool="levels">
                            <i class="fas fa-layer-group"></i> S/R Levels
                        </button>
                        <button class="tool-btn" data-tool="fibonacci">
                            <i class="fas fa-wave-square"></i> Fibonacci
                        </button>
                        <button class="tool-btn" data-tool="clear">
                            <i class="fas fa-eraser"></i> Clear All
                        </button>
                    </div>
                </div>
                <div class="timeframe-selector">
                    <button class="tf-btn" data-tf="1">1M</button>
                    <button class="tf-btn" data-tf="5">5M</button>
                    <button class="tf-btn" data-tf="15">15M</button>
                    <button class="tf-btn active" data-tf="60">1H</button>
                    <button class="tf-btn" data-tf="240">4H</button>
                    <button class="tf-btn" data-tv="D">D</button>
                </div>
            </div>
            <div id="tv_chart_container" style="height: 100%;">
                <div id="tv_chart" style="height: 100%;"></div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <div class="warning">
            <i class="fas fa-exclamation-triangle"></i> 
            VISUAL ANALYSIS RULES: Minimum 3 confirmations required. No trades on conflicting signals.
        </div>
        <div>© KILLER ZONE Visual Analysis Dashboard | Gold • BTC • EURUSD • NAS100 • US30</div>
    </div>

    <!-- External Libraries -->
    <script src="https://s3.tradingview.com/tv.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    
    <script>
        // KILLER ZONE Visual Analysis System
        const VISUAL_ANALYSIS = {
            // Configuration
            config: {
                assets: {
                    XAUUSD: { 
                        name: "Gold", 
                        tvSymbol: "TVC:GOLD",
                        category: "gold",
                        color: "var(--gold)"
                    },
                    BTCUSD: { 
                        name: "Bitcoin", 
                        tvSymbol: "BINANCE:BTCUSDT",
                        category: "btc",
                        color: "var(--btc)"
                    },
                    EURUSD: { 
                        name: "EUR/USD", 
                        tvSymbol: "FX_IDC:EURUSD",
                        category: "forex",
                        color: "var(--forex)"
                    },
                    NAS100: { 
                        name: "NAS100", 
                        tvSymbol: "NASDAQ:NDX",
                        category: "indices",
                        color: "var(--neutral)"
                    },
                    US30: { 
                        name: "US30", 
                        tvSymbol: "FOREXCOM:DJI",
                        category: "indices",
                        color: "var(--neutral)"
                    }
                },
                
                // Visual confirmation categories
                confirmations: [
                    "Market Structure (HH/HL or LH/LL)",
                    "Trend Direction Alignment",
                    "RSI/Oscillator Confirmation",
                    "Support/Resistance Alignment",
                    "Candlestick Pattern",
                    "Volume Confirmation",
                    "Breakout/Rejection Pattern"
                ]
            },
            
            // State Management
            state: {
                activeAsset: 'XAUUSD',
                analysisMode: 'realtime',
                currentTimeframe: '60',
                chartWidget: null,
                
                // Asset data (NO EMA ALIGNMENT DATA)
                assetData: {
                    XAUUSD: {
                        price: 2180.45,
                        change: 0.65,
                        trend: 'bullish',
                        rsi: 62.5,
                        structure: 'HH/HL',
                        momentum: 'bullish',
                        candlePattern: 'bullish_continuation',
                        support: [2165, 2170],
                        resistance: [2190, 2195],
                        signal: 'BUY',
                        confirmations: 3,
                        analysis: "Bullish structure with clear HH/HL pattern"
                    },
                    BTCUSD: {
                        price: 68245.80,
                        change: 2.35,
                        trend: 'bullish',
                        rsi: 58.2,
                        structure: 'HH/HL',
                        momentum: 'bullish',
                        candlePattern: 'bullish_continuation',
                        support: [67000, 67500],
                        resistance: [69000, 69500],
                        signal: 'BUY',
                        confirmations: 3,
                        analysis: "Strong uptrend with bullish momentum"
                    },
                    EURUSD: {
                        price: 1.0956,
                        change: -0.15,
                        trend: 'bearish',
                        rsi: 42.3,
                        structure: 'LH/LL',
                        momentum: 'bearish',
                        candlePattern: 'bearish_continuation',
                        support: [1.0920, 1.0930],
                        resistance: [1.0980, 1.1000],
                        signal: 'SELL',
                        confirmations: 3,
                        analysis: "Downtrend with lower highs and lower lows"
                    },
                    NAS100: {
                        price: 17842.35,
                        change: 0.85,
                        trend: 'bullish',
                        rsi: 68.7,
                        structure: 'HH/HL',
                        momentum: 'bullish',
                        candlePattern: 'bullish_continuation',
                        support: [17700, 17750],
                        resistance: [17900, 17950],
                        signal: 'BUY',
                        confirmations: 3,
                        analysis: "Uptrend continuation, testing resistance"
                    },
                    US30: {
                        price: 39215.60,
                        change: -0.32,
                        trend: 'ranging',
                        rsi: 49.5,
                        structure: 'Ranging',
                        momentum: 'neutral',
                        candlePattern: 'indecision',
                        support: [39000, 39100],
                        resistance: [39300, 39400],
                        signal: 'NO_TRADE',
                        confirmations: 1,
                        analysis: "Range-bound with conflicting signals"
                    }
                },
                
                // Active analysis
                activeAnalysis: null
            },
            
            // Initialize TradingView with visual analysis tools
            initTradingView() {
                if (window.tvWidget) {
                    window.tvWidget.remove();
                }
                
                const symbol = this.config.assets[this.state.activeAsset].tvSymbol;
                
                window.tvWidget = new TradingView.widget({
                    container_id: "tv_chart",
                    autosize: true,
                    symbol: symbol,
                    interval: this.state.currentTimeframe,
                    timezone: "UTC",
                    theme: "dark",
                    style: "1",
                    toolbar_bg: "#0b102a",
                    enable_publishing: false,
                    hide_side_toolbar: false,
                    allow_symbol_change: false,
                    details: true,
                    hotlist: false,
                    calendar: false,
                    drawing_toolbar: true,
                    disabled_features: ["use_localstorage_for_settings"],
                    enabled_features: ["study_templates"],
                    studies: [
                        "RSI@tv-basicstudies",
                        "Volume@tv-basicstudies",
                        "AverageTrueRange@tv-basicstudies"
                    ],
                    overrides: {
                        "paneProperties.background": "#0b102a",
                        "paneProperties.vertGridProperties.color": "rgba(255,255,255,0.05)",
                        "paneProperties.horzGridProperties.color": "rgba(255,255,255,0.05)",
                        "mainSeriesProperties.candleStyle.upColor": "#00c853",
                        "mainSeriesProperties.candleStyle.downColor": "#ff3d00",
                        "mainSeriesProperties.candleStyle.borderUpColor": "#00c853",
                        "mainSeriesProperties.candleStyle.borderDownColor": "#ff3d00",
                        "mainSeriesProperties.candleStyle.wickUpColor": "#00c853",
                        "mainSeriesProperties.candleStyle.wickDownColor": "#ff3d00"
                    },
                    studies_overrides: {
                        "rsi.display": "line",
                        "rsi.linewidth": 2,
                        "rsi.plots.0.color": "#ff9800",
                        "volume.volume.color.0": "rgba(255, 61, 0, 0.5)",
                        "volume.volume.color.1": "rgba(0, 200, 83, 0.5)"
                    }
                });
                
                this.updateChartInfo();
            },
            
            // Perform visual analysis on selected asset
            performVisualAnalysis(asset) {
                const data = this.state.assetData[asset];
                this.state.activeAnalysis = data;
                this.updateVisualAnalysisUI();
                this.updateSignalDecision();
            },
            
            // Update visual analysis UI (NO EMA ALIGNMENT)
            updateVisualAnalysisUI() {
                const data = this.state.activeAnalysis;
                if (!data) return;
                
                // Market Structure
                this.updateAnalysisItem('structure-hl', 
                    data.structure.includes('HL') ? 'bullish' : 'neutral',
                    data.structure.includes('HL') ? 'Confirmed ✓' : 'Not Present'
                );
                
                this.updateAnalysisItem('structure-hh', 
                    data.structure.includes('HH') ? 'bullish' : 'neutral',
                    data.structure.includes('HH') ? 'Present ✓' : 'Not Present'
                );
                
                this.updateAnalysisItem('structure-lh', 
                    data.structure.includes('LH') ? 'bearish' : 'neutral',
                    data.structure.includes('LH') ? 'Present' : 'Not Present'
                );
                
                this.updateAnalysisItem('structure-ll', 
                    data.structure.includes('LL') ? 'bearish' : 'neutral',
                    data.structure.includes('LL') ? 'Present' : 'Not Present'
                );
                
                // Trend & Momentum
                this.updateAnalysisItem('trend-direction', 
                    data.trend === 'bullish' ? 'bullish' : data.trend === 'bearish' ? 'bearish' : 'neutral',
                    data.trend.charAt(0).toUpperCase() + data.trend.slice(1)
                );
                
                // RSI Status with color coding
                let rsiStatus = 'neutral';
                let rsiText = `${data.rsi} (`;
                if (data.rsi <= 30) {
                    rsiStatus = 'bullish';
                    rsiText += 'Oversold)';
                } else if (data.rsi >= 70) {
                    rsiStatus = 'bearish';
                    rsiText += 'Overbought)';
                } else if (data.rsi > 50) {
                    rsiStatus = 'bullish';
                    rsiText += 'Bullish Bias)';
                } else {
                    rsiStatus = 'bearish';
                    rsiText += 'Bearish Bias)';
                }
                
                this.updateAnalysisItem('rsi-status', rsiStatus, rsiText);
                
                // Momentum based on trend
                this.updateAnalysisItem('momentum', 
                    data.momentum,
                    data.momentum === 'bullish' ? 'Bullish Bars' : 
                    data.momentum === 'bearish' ? 'Bearish Bars' : 'Mixed Momentum'
                );
                
                // Candle Pattern
                let candleStatus = 'neutral';
                if (data.candlePattern.includes('bullish')) candleStatus = 'bullish';
                else if (data.candlePattern.includes('bearish')) candleStatus = 'bearish';
                
                this.updateAnalysisItem('candle-pattern', 
                    candleStatus,
                    data.candlePattern.replace('_', ' ').charAt(0).toUpperCase() + 
                    data.candlePattern.replace('_', ' ').slice(1)
                );
                
                // Key Levels
                this.updateAnalysisItem('support-level', 'neutral', 
                    `${data.support[0]} - ${data.support[1]}`
                );
                
                this.updateAnalysisItem('resistance-level', 'neutral', 
                    `${data.resistance[0]} - ${data.resistance[1]}`
                );
                
                this.updateAnalysisItem('price-position', 
                    data.trend === 'bullish' ? 'bullish' : 'neutral',
                    data.trend === 'bullish' ? 'Above Support ✓' : 'Near Support'
                );
                
                this.updateAnalysisItem('breakout-status', 'neutral', 
                    data.trend === 'bullish' ? 'Testing Resistance' : 
                    data.trend === 'bearish' ? 'Testing Support' : 'Range Bound'
                );
                
                // Update confirmations
                this.updateConfirmations(data);
            },
            
            updateAnalysisItem(elementId, type, value) {
                const element = document.getElementById(elementId);
                if (element) {
                    element.className = `analysis-item ${type}`;
                    element.querySelector('.item-value').textContent = value;
                }
            },
            
            updateConfirmations(data) {
                const container = document.getElementById('confirmations-container');
                if (!container) return;
                
                // Generate confirmations based on analysis (NO EMA)
                const confirmations = [
                    {
                        confirmed: data.structure.includes('HH') && data.structure.includes('HL'),
                        title: "Higher Lows Pattern",
                        description: data.structure.includes('HH') && data.structure.includes('HL') ? 
                            "Clear HH/HL structure confirms uptrend" : "Lack of clear structure"
                    },
                    {
                        confirmed: data.trend !== 'ranging',
                        title: "Trend Direction",
                        description: data.trend !== 'ranging' ? 
                            `Clear ${data.trend} trend established` : "No clear trend direction"
                    },
                    {
                        confirmed: data.momentum === data.trend,
                        title: "Momentum Confirmation",
                        description: data.momentum === data.trend ? 
                            `${data.trend} momentum confirms trend` : "Momentum conflict with trend"
                    },
                    {
                        confirmed: (data.trend === 'bullish' && data.rsi > 50) || 
                                  (data.trend === 'bearish' && data.rsi < 50),
                        title: "RSI Trend Confirmation",
                        description: data.trend === 'bullish' && data.rsi > 50 ? 
                            "RSI shows bullish momentum" : 
                            data.trend === 'bearish' && data.rsi < 50 ? 
                            "RSI shows bearish momentum" : "RSI neutral/no confirmation"
                    }
                ];
                
                container.innerHTML = '';
                
                confirmations.forEach((conf, index) => {
                    const confElement = document.createElement('div');
                    confElement.className = `confirmation-item ${conf.confirmed ? 'confirmed' : ''}`;
                    confElement.innerHTML = `
                        <div class="confirmation-check ${conf.confirmed ? 'check-confirmed' : ''}">
                            <i class="fas fa-${conf.confirmed ? 'check' : 'minus'}"></i>
                        </div>
                        <div>
                            <div style="font-weight:bold;">${conf.title}</div>
                            <div style="font-size:0.8rem;color:var(--text-secondary)">${conf.description}</div>
                        </div>
                    `;
                    container.appendChild(confElement);
                });
                
                // Update confirmation count
                const confirmedCount = confirmations.filter(c => c.confirmed).length;
                document.getElementById('confirmation-count').textContent = 
                    `${confirmedCount}/${confirmations.length} Confirmations`;
            },
            
            updateSignalDecision() {
                const data = this.state.activeAnalysis;
                if (!data) return;
                
                const decisionElement = document.querySelector('.signal-decision');
                const decisionText = document.querySelector('.decision-text');
                const trendBias = document.querySelector('.trend-bias');
                const analysisSummary = document.querySelector('.analysis-summary');
                
                // Update trend bias
                trendBias.className = `trend-bias trend-${data.trend}`;
                trendBias.innerHTML = `<i class="fas fa-arrow-${data.trend === 'bullish' ? 'up' : data.trend === 'bearish' ? 'down' : 'right'}"></i> TREND BIAS: ${data.trend.toUpperCase()}`;
                
                // Update decision
                decisionElement.className = `signal-decision signal-${data.signal.toLowerCase()}-decision`;
                decisionText.className = `decision-text decision-${data.signal.toLowerCase().replace('_', '-')}`;
                decisionText.innerHTML = `<i class="fas fa-${data.signal === 'BUY' ? 'thumbs-up' : data.signal === 'SELL' ? 'thumbs-down' : 'ban'}"></i> SIGNAL: ${data.signal.replace('_', ' ')}`;
                
                // Update analysis summary
                analysisSummary.innerHTML = `
                    <strong>ANALYSIS SUMMARY:</strong><br>
                    ${data.analysis} Price is currently at ${this.formatPrice(data.price)}. 
                    The ${data.trend} trend is confirmed by ${data.confirmations} visual confirmations. 
                    ${data.signal === 'NO_TRADE' ? 'Conflicting signals prevent a clear trade setup.' : 'All visual confirmations align with the signal direction.'}
                `;
            },
            
            formatPrice(price) {
                const asset = this.state.activeAsset;
                if (asset === 'XAUUSD') {
                    return price.toFixed(2);
                } else if (asset === 'BTCUSD') {
                    return price.toFixed(0);
                } else if (asset === 'EURUSD') {
                    return price.toFixed(4);
                } else {
                    return price.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                }
            },
            
            updateChartInfo() {
                const asset = this.config.assets[this.state.activeAsset];
                const data = this.state.assetData[this.state.activeAsset];
                
                document.getElementById('chart-symbol-name').textContent = 
                    `${asset.name} (${this.state.activeAsset}) - ${this.getTimeframeText()} Chart`;
                
                document.getElementById('chart-trend').textContent = 
                    data.trend.charAt(0).toUpperCase() + data.trend.slice(1);
                document.getElementById('chart-trend').style.color = 
                    data.trend === 'bullish' ? 'var(--positive)' : 
                    data.trend === 'bearish' ? 'var(--negative)' : 'var(--warning)';
                
                document.getElementById('chart-rsi').textContent = data.rsi;
                document.getElementById('chart-rsi').style.color = 
                    data.rsi <= 30 ? 'var(--positive)' : 
                    data.rsi >= 70 ? 'var(--negative)' : 'var(--warning)';
                
                document.getElementById('chart-structure').textContent = data.structure;
                document.getElementById('chart-structure').style.color = 
                    data.structure.includes('HH') ? 'var(--positive)' : 
                    data.structure.includes('LH') ? 'var(--negative)' : 'var(--warning)';
                
                document.getElementById('chart-momentum').textContent = 
                    data.momentum.charAt(0).toUpperCase() + data.momentum.slice(1);
                document.getElementById('chart-momentum').style.color = 
                    data.momentum === 'bullish' ? 'var(--positive)' : 
                    data.momentum === 'bearish' ? 'var(--negative)' : 'var(--warning)';
                
                document.getElementById('current-asset').textContent = `${asset.name} (${this.state.activeAsset})`;
            },
            
            getTimeframeText() {
                const tfMap = {
                    '1': '1M', '5': '5M', '15': '15M', 
                    '60': '1H', '240': '4H', 'D': 'Daily'
                };
                return tfMap[this.state.currentTimeframe] || this.state.currentTimeframe;
            },
            
            // Simulate market data updates
            simulateMarketUpdates() {
                Object.keys(this.state.assetData).forEach(asset => {
                    const data = this.state.assetData[asset];
                    
                    // Small random price changes
                    const randomChange = (Math.random() - 0.5) * 0.2;
                    data.price += data.price * (randomChange / 100);
                    
                    // Update change percentage
                    data.change = randomChange;
                    
                    // Small RSI fluctuations
                    data.rsi += (Math.random() - 0.5) * 2;
                    data.rsi = Math.max(0, Math.min(100, data.rsi));
                    
                    // Update asset card
                    this.updateAssetCard(asset);
                });
                
                // Update active asset analysis if needed
                if (this.state.activeAnalysis) {
                    this.performVisualAnalysis(this.state.activeAsset);
                }
            },
            
            updateAssetCard(asset) {
                const data = this.state.assetData[asset];
                const priceEl = document.getElementById(`${asset.toLowerCase()}-price`);
                const changeEl = document.getElementById(`${asset.toLowerCase()}-change`);
                const card = document.querySelector(`.asset-card[data-symbol="${asset}"]`);
                
                if (priceEl) {
                    // Format price based on asset type
                    let formattedPrice;
                    if (asset === 'XAUUSD') {
                        formattedPrice = data.price.toFixed(2);
                    } else if (asset === 'BTCUSD') {
                        formattedPrice = data.price.toFixed(0);
                    } else if (asset === 'EURUSD') {
                        formattedPrice = data.price.toFixed(4);
                    } else {
                        formattedPrice = data.price.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                    }
                    priceEl.textContent = formattedPrice;
                }
                
                if (changeEl) {
                    changeEl.textContent = `${data.change >= 0 ? '+' : ''}${data.change.toFixed(2)}%`;
                    changeEl.className = `asset-change ${data.change >= 0 ? 'change-up' : 'change-down'}`;
                }
                
                if (card) {
                    card.classList.remove('buy-signal', 'sell-signal');
                    if (data.signal === 'BUY') {
                        card.classList.add('buy-signal');
                    } else if (data.signal === 'SELL') {
                        card.classList.add('sell-signal');
                    }
                }
            },
            
            // Event Handlers
            setupEventListeners() {
                // Asset selection
                document.querySelectorAll('.asset-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const symbol = card.getAttribute('data-symbol');
                        
                        // Remove active class from all cards
                        document.querySelectorAll('.asset-card').forEach(c => {
                            c.classList.remove('active');
                        });
                        
                        // Add active class to clicked card
                        card.classList.add('active');
                        
                        // Update state
                        this.state.activeAsset = symbol;
                        
                        // Perform visual analysis
                        this.performVisualAnalysis(symbol);
                        
                        // Update chart
                        this.updateChartInfo();
                        this.initTradingView();
                    });
                });
                
                // Analysis mode buttons
                document.querySelectorAll('.session-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const mode = btn.getAttribute('data-mode');
                        
                        // Remove active class from all buttons
                        document.querySelectorAll('.session-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // Add active class to clicked button
                        btn.classList.add('active');
                        
                        // Update state
                        this.state.analysisMode = mode;
                        document.getElementById('analysis-status').textContent = 
                            mode === 'realtime' ? 'Live Analysis Active' : 'Historical Analysis Mode';
                    });
                });
                
                // Timeframe buttons
                document.querySelectorAll('.tf-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tf = btn.getAttribute('data-tf');
                        
                        // Remove active class from all buttons
                        document.querySelectorAll('.tf-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // Add active class to clicked button
                        btn.classList.add('active');
                        
                        // Update state and chart
                        this.state.currentTimeframe = tf;
                        
                        if (window.tvWidget) {
                            window.tvWidget.setChartType(tf);
                        }
                        
                        this.updateChartInfo();
                    });
                });
                
                // Chart tools
                document.querySelectorAll('.tool-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const tool = btn.getAttribute('data-tool');
                        
                        // Remove active class from all buttons
                        document.querySelectorAll('.tool-btn').forEach(b => {
                            b.classList.remove('active');
                        });
                        
                        // Add active class to clicked button
                        btn.classList.add('active');
                        
                        // Handle tool activation
                        this.handleChartTool(tool);
                    });
                });
            },
            
            handleChartTool(tool) {
                toastr.info(`Chart tool activated: ${tool}`, "Visual Analysis", { timeOut: 2000 });
                
                // In a real implementation, this would interact with TradingView's drawing tools
                switch(tool) {
                    case 'trendlines':
                        console.log("Trendline drawing activated");
                        break;
                    case 'levels':
                        console.log("Support/Resistance levels activated");
                        break;
                    case 'fibonacci':
                        console.log("Fibonacci tool activated");
                        break;
                    case 'clear':
                        console.log("Clearing all drawings");
                        break;
                }
            },
            
            // Initialize everything
            init() {
                // Setup toastr
                toastr.options = {
                    positionClass: 'toast-top-right',
                    progressBar: true,
                    timeOut: 3000,
                    closeButton: true
                };
                
                // Setup event listeners
                this.setupEventListeners();
                
                // Initial visual analysis on default asset
                this.performVisualAnalysis(this.state.activeAsset);
                
                // Update all asset cards
                Object.keys(this.state.assetData).forEach(asset => {
                    this.updateAssetCard(asset);
                });
                
                // Initialize TradingView
                setTimeout(() => {
                    this.initTradingView();
                }, 1000);
                
                // Set up market simulation updates
                setInterval(() => {
                    if (this.state.analysisMode === 'realtime') {
                        this.simulateMarketUpdates();
                    }
                }, 5000);
            }
        };
        
        // Start the Visual Analysis system
        document.addEventListener('DOMContentLoaded', () => {
            VISUAL_ANALYSIS.init();
        });
    </script>
</body>
</html>
